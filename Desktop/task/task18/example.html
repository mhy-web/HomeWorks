<!DOCTYPE html>
<html lang="en">
	<head>
		<style type="text/css">
		.content{
			position: relative;

		}

		.item{
			position: absolute;
			width: 200px;
			margin-right: 10px;
			margin-top: 10px;
			transition: all 1s;
		}

		.h1{
			height: 200px;
			background-color: #f4b300;
		}

		.h2{
			height: 300px;
			background-color: #691BB8;
		}

		.h3{
			height: 400px;
			background-color: #006ac1;
		}

		</style>
<script src="http://apps.bdimg.com/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript">


 $(function(){

 	function render(){

	  	var nodeWidth = $('.item').outerWidth(true),
	 		colNum = parseInt($(window).width()/nodeWidth),
	 		colSumHeight = [];

	 	for(var i = 0; i<colNum;i++){
	 		colSumHeight.push(0);
	 	}

	 	$('.item').each(function(){
	 		var $cur = $(this);

	 		//colSumHeight = [100, 250, 80, 200]

	 		var idx = 0,
	 			minSumHeight = colSumHeight[0];

	 		for(var i=0;i<colSumHeight.length; i++){
	 			if(colSumHeight[i] < minSumHeight){
	 				idx = i;
	 				minSumHeight = colSumHeight[i];
	 			}
	 		}

	 		$cur.css({
	 			left: nodeWidth*idx,
	 			top: minSumHeight
	 		});
	 		colSumHeight[idx] = $cur.outerHeight(true) + colSumHeight[idx];
	 	});
 	}

 	render();

 	$(window).on('resize', function(){
 		render();
 	})



  //鏂规硶2锛� 閫氳繃闂寘杩涜绉佹湁鍖栧皝瑁�


 	var water = (function($){

	 	function render(){

		  	var nodeWidth = $('.item').outerWidth(true),
		 		colNum = parseInt($(window).width()/nodeWidth),
		 		colSumHeight = [];

		 	for(var i = 0; i<colNum;i++){
		 		colSumHeight.push(0);
		 	}

		 	$('.item').each(function(){
		 		var $cur = $(this);

		 		//colSumHeight = [100, 250, 80, 200]

		 		var idx = 0,
		 			minSumHeight = colSumHeight[0];

		 		for(var i=0;i<colSumHeight.length; i++){
		 			if(colSumHeight[i] < minSumHeight){
		 				idx = i;
		 				minSumHeight = colSumHeight[i];
		 			}
		 		}

		 		$cur.css({
		 			left: nodeWidth*idx,
		 			top: minSumHeight
		 		});
		 		colSumHeight[idx] = $cur.outerHeight(true) + colSumHeight[idx];
		 	});
	 	}

	 	render();

	 	$(window).on('resize', function(){
	 		render();
	 	})


 		return {
 			init: render
 		}
 	})(jQuery)

 	//water.init();



// 鏂规硶3锛� 鎶婂姛鑳介兘缁戝畾鍒颁竴涓璞′笂

	var WaterFall = {

		//[0,0,0,0]
		//[20, 10, 30, 15]

		arrColHeight: [],

		init: function( $ct ){
			this.$ct = $ct;
			this.$items = $ct.find('.item'),
			this.itemWidth = this.$items.outerWidth(true);

			this.bind();
			this.start();
		},

		bind: function(){
			var me = this;
			$(window).on('resize', function(){
				me.start();
			});
		},

		start: function(){
			var me = this;
			this.colNum = Math.floor( this.$ct.width() / this.itemWidth );
			//this.arrColHeight = [];
			for(var i=0; i<this.colNum; i++){
				this.arrColHeight[i] = 0;
			}
			this.$items.each(function(){
				me.placeItem( $(this) );
			});
		},

		placeItem: function( $el ) {
			// 1. 鎵惧埌arrColHeight鐨勬渶灏忓€硷紝寰楀埌鏄鍑犲垪
			// 2. 鍏冪礌left鐨勫€兼槸 鍒楁暟*瀹藉害
			// 3. 鍏冪礌top鐨勫€兼槸 鏈€灏忓€�
			// 4. 鏀剧疆鍏冪礌鐨勪綅缃紝鎶奱rrColHeight瀵瑰簲鐨勫垪鏁扮殑鍊煎姞涓婂綋鍓嶅厓绱犵殑楂樺害
			var obj = this.getIndexOfMin(this.arrColHeight),
				idx = obj.idx,
				min = obj.min;
			$el.css({
				left: idx * this.itemWidth,
				top: min
			});
			this.arrColHeight[idx] += $el.outerHeight(true);
		},

		getIndexOfMin: function( arr ){
			var min = arr[0],
				idx = 0;
			for(var i = 1; i< arr.length; i++){
				if(min > arr[i]){
					min = arr[i];
					idx = i;
				}
			}
			return {min: min, idx: idx};
		}
	}

	//WaterFall.init($('.content'));


 });


</script>

	</head>
	<body>
		<div class="content">
			<div class="item h1">
				1
			</div>
			<div class="item h3">
				2
			</div>
			<div class="item h2">
				3
			</div>
			<div class="item h1">
				4
			</div>
			<div class="item h1">
				5
			</div>
			<div class="item h3">
				6
			</div>
			<div class="item h3">
				7
			</div>
 				<div class="item h2">
				8
			</div>
    	<div class="item h1">
				9
			</div>
			<div class="item h3">
				10
			</div>
			<div class="item h3">
				11
			</div>
			<div class="item h3">
				12
			</div>
			<div class="item h2">
				13
			</div>
			<div class="item h2">
				14
			</div>
		</div>

		<script type="text/javascript">
		
		waterfull()

		$(window).resize(function(){
			waterfull()
		})


		function waterfull(){
			var colLength = parseInt($('.content').width()/$('.item').width())
			var itemArr = []
			for(var i = 0; i < colLength; i++) {
				itemArr[i] = 0
			}

			$('.item').each(function(){
				var minValue = Math.min.apply(null, itemArr)
				var minIndex = itemArr.indexOf(minValue)

				$(this).css({
					top: itemArr[minIndex],
					left: $(this).outerWidth(true) * minIndex
				})

				itemArr[minIndex] += $(this).outerHeight(true)

			})		
		}
		
		


	// 	var WaterFall = (function(){
	// 		function init(){
	// 			waterfull()
	// 			$(window).resize(function(){
	// 				waterfull()
	// 			})
	// 		}

	// 		function waterfull(){
	// 			var colLength = parseInt($('.content').width()/$('.item').outerWidth(true))
	// 			var itemArr = []
	// 			for(var i = 0; i < colLength; i++) {
	// 				itemArr[i] = 0
	// 			}

	// 			$('.item').each(function(){
	// 				var minValue = Math.min.apply(null, itemArr)
	// 				var minIndex = itemArr.indexOf(minValue)

	// 				$(this).css({
	// 					top: itemArr[minIndex],
	// 					left: $(this).outerWidth(true) * minIndex
	// 				})

	// 				itemArr[minIndex] += $(this).outerHeight(true)

	// 			})		
	// 		}
			
	// 		return {
	// 			init: 1
	// 		}
	// 	})()


	// var WaterFall = (function(){		
			
	// 		var ret =  { init: 1 }
	// 		return ret
	// 	})()

		</script>
	</body>
</html>
